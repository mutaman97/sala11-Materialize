import{b as Re,f as Ue}from"./formatters-COAB7S_x.js";import{r as D,x as se,o as v,e as B,w as t,a as e,h as r,d as x,b as s,u as l,i as G,c as b,f as q,V as ie,F as S,j as T,t as $,a6 as fe,a4 as he,P as J,Q as K,R as j,z as ae,g as Te,v as W,A as Be,ak as Pe}from"./main-Cw78g-lL.js";import{_ as xe}from"./MoreBtn-CMrC8hcg.js";import{P as ue}from"./vue3-perfect-scrollbar.esm-Bq_YvC2Z.js";import{I as ke,L as be}from"./index-CJw4XIx2.js";import{u as ye,S as $e,P as Ce,U as we,E as Ve}from"./index-BDZnHo-B.js";import{V as ve}from"./index-DhMs0plD.js";import{a as Ne,c as Oe,V as ne}from"./VCard-DLuue0SI.js";import{V as X}from"./VTextField-BKkE6jAr.js";import{V as U}from"./VDivider-qVXjHTOM.js";import{V as Y}from"./VMenu-DypGLeY7.js";import{V as Z,a as ee,b as oe}from"./VList-DJjA2_W7.js";import{V as Q}from"./VSpacer-B4bUzx1D.js";import{V as me}from"./VBadge-hYR-JcPm.js";import{$ as ge}from"./api-COQrmxD3.js";import{V as Fe}from"./VChip-BmMdWnsY.js";import{V as R}from"./VTooltip-Csjob21H.js";import{V as le}from"./VCardText-CmcafK4F.js";import{V as Le}from"./VAvatar-BFNrWSvb.js";import{V as de}from"./VImg-DHwMjE9V.js";import{V as Me}from"./VNavigationDrawer-C2oWxnQR.js";import{u as je,V as qe,a as He}from"./VMain-CpjONLyH.js";import{u as Ge}from"./useApi-DW-wMX_v.js";import{c as Je}from"./createUrl-DmHIyhWr.js";import{V as _e}from"./VCheckbox-CYOBAj51.js";import"./helpers-cDhjtOJI.js";/* empty css                   */import"./VCounter-Dgzvj9pV.js";import"./VField-Chh8HzJD.js";import"./form-wczSFyJg.js";import"./easing-DY7PVvcf.js";import"./VInput-B2AKhCeD.js";import"./forwardRefs-C-GTDzx5.js";import"./VOverlay-DS9RY67J.js";import"./lazy-Dz28_Vpk.js";import"./scopeId-Dq-41LqQ.js";import"./dialog-transition-DYOtB0Vc.js";import"./ssrBoot-B8feSXE9.js";/* empty css              */import"./index-CvdUsmOx.js";import"./VSlideGroup-BHv8mlqE.js";import"./VCheckboxBtn-BX36Snjb.js";import"./VSelectionControl-DVPi5H3e.js";const Ke={class:"pe-5"},Qe=s("div",{class:"text-body-1 text-disabled font-weight-medium"}," To: ",-1),We={class:"d-flex text-body-1 cursor-pointer text-medium-emphasis"},Xe=s("div",{class:"mx-1"},"|",-1),Ye={key:0},Ze=s("div",{class:"text-body-1 text-disabled font-weight-medium"}," Cc: ",-1),et={key:0},tt=s("div",{class:"text-body-1 text-disabled font-weight-medium"}," Bcc: ",-1),lt=s("div",{class:"text-body-1 text-disabled font-weight-medium"}," Subject: ",-1),at={class:"tiptap-editor-wrapper"},it={key:0,class:"d-flex flex-wrap gap-x-1 px-4 py-2"},nt={class:"mx-5"},ot={class:"d-flex align-center px-5 py-4 gap-4"},st={__name:"ComposeDialog",emits:["close"],setup(M,{emit:E}){const f=D(""),V=D(""),y=D(""),A=D(""),I=D(""),h=D(!1),g=D(!1),C=()=>{f.value=A.value=I.value=""},d=ye({content:"",extensions:[$e,ke,Ce.configure({placeholder:"Message"}),we,be.configure({openOnClick:!1})]}),P=()=>{var c,a,m;const L=(c=d.value)==null?void 0:c.getAttributes("link").href,i=window.prompt("URL",L);if(i!==null){if(i===""){(a=d.value)==null||a.chain().focus().extendMarkRange("link").unsetLink().run();return}(m=d.value)==null||m.chain().focus().extendMarkRange("link").setLink({href:i}).run()}},_=()=>{var i;const L=window.prompt("URL");L&&((i=d.value)==null||i.chain().focus().setImage({src:L}).run())};return(L,i)=>{const c=se("IconBtn");return v(),B(ne,{class:"email-compose-dialog",elevation:"10","max-width":"30vw"},{default:t(()=>[e(Ne,{class:"py-3"},{append:t(()=>[e(c,{size:"small",onClick:i[0]||(i[0]=a=>L.$emit("close"))},{default:t(()=>[e(r,{icon:"ri-subtract-line"})]),_:1}),e(c,{size:"small",onClick:i[1]||(i[1]=a=>{L.$emit("close"),C()})},{default:t(()=>[e(r,{icon:"ri-close-line"})]),_:1})]),default:t(()=>[e(Oe,{class:"text-medium-emphasis"},{default:t(()=>[x(" Compose Mail ")]),_:1})]),_:1}),s("div",Ke,[e(X,{modelValue:l(f),"onUpdate:modelValue":i[4]||(i[4]=a=>G(f)?f.value=a:null),density:"compact"},{"prepend-inner":t(()=>[Qe]),append:t(()=>[s("span",We,[s("div",{onClick:i[2]||(i[2]=a=>h.value=!l(h))},"Cc"),Xe,s("div",{onClick:i[3]||(i[3]=a=>g.value=!l(g))},"Bcc")])]),_:1},8,["modelValue"])]),e(ve,null,{default:t(()=>[l(h)?(v(),b("div",Ye,[e(U),e(X,{modelValue:l(V),"onUpdate:modelValue":i[5]||(i[5]=a=>G(V)?V.value=a:null),density:"compact"},{"prepend-inner":t(()=>[Ze]),_:1},8,["modelValue"])])):q("",!0)]),_:1}),e(ve,null,{default:t(()=>[l(g)?(v(),b("div",et,[e(U),e(X,{modelValue:l(y),"onUpdate:modelValue":i[6]||(i[6]=a=>G(y)?y.value=a:null),density:"compact"},{"prepend-inner":t(()=>[tt]),_:1},8,["modelValue"])])):q("",!0)]),_:1}),e(U),e(X,{modelValue:l(A),"onUpdate:modelValue":i[7]||(i[7]=a=>G(A)?A.value=a:null),density:"compact"},{"prepend-inner":t(()=>[lt]),_:1},8,["modelValue"]),e(U),s("div",at,[l(d)?(v(),b("div",it,[e(c,{size:"small",rounded:"",color:l(d).isActive("bold")?"primary":"",variant:l(d).isActive("bold")?"tonal":"text",onClick:i[8]||(i[8]=a=>l(d).chain().focus().toggleBold().run())},{default:t(()=>[e(r,{icon:"ri-bold"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",color:l(d).isActive("underline")?"primary":"",variant:l(d).isActive("underline")?"tonal":"text",onClick:i[9]||(i[9]=a=>l(d).commands.toggleUnderline())},{default:t(()=>[e(r,{icon:"ri-underline"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",color:l(d).isActive("italic")?"primary":"",variant:l(d).isActive("italic")?"tonal":"text",onClick:i[10]||(i[10]=a=>l(d).chain().focus().toggleItalic().run())},{default:t(()=>[e(r,{icon:"ri-italic"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",color:l(d).isActive("bulletList")?"primary":"",variant:l(d).isActive("bulletList")?"tonal":"text",onClick:i[11]||(i[11]=a=>l(d).chain().focus().toggleBulletList().run())},{default:t(()=>[e(r,{icon:"ri-list-check"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",color:l(d).isActive("orderedList")?"primary":"",variant:l(d).isActive("orderedList")?"tonal":"text",onClick:i[12]||(i[12]=a=>l(d).chain().focus().toggleOrderedList().run())},{default:t(()=>[e(r,{icon:"ri-list-ordered-2"})]),_:1},8,["color","variant"]),e(c,{size:"small",rounded:"",onClick:P},{default:t(()=>[e(r,{icon:"ri-links-line"})]),_:1}),e(c,{size:"small",rounded:"",onClick:_},{default:t(()=>[e(r,{icon:"ri-image-line"})]),_:1})])):q("",!0),e(U),s("div",nt,[e(l(Ve),{editor:l(d)},null,8,["editor"])])]),s("div",ot,[e(ie,{"append-icon":"ri-send-plane-line"},{default:t(()=>[x(" Send "),e(Y,{activator:"parent"},{default:t(()=>[e(Z,null,{default:t(()=>[(v(),b(S,null,T(["Schedule Mail","Save Draft","Sent"],(a,m)=>e(ee,{key:m,value:m},{default:t(()=>[x($(a),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1})]),_:1}),e(c,{size:"small"},{default:t(()=>[e(r,{icon:"ri-attachment-2"})]),_:1}),e(Q),e(c,{size:"small"},{default:t(()=>[e(r,{icon:"ri-more-2-line"})]),_:1}),e(c,{size:"small",onClick:i[13]||(i[13]=a=>{L.$emit("close"),C()})},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"})]),_:1})])]),_:1})}}},rt={class:"d-flex flex-column h-100"},dt={class:"pa-5"},ct={class:"email-filters-labels"},ut=["href","onClick"],mt={class:"text-base"},pt=s("li",{class:"text-sm d-block text-uppercase text-disabled mt-6 mb-3"}," LABELS ",-1),ft=["href","onClick"],vt={class:"text-body-1 text-high-emphasis d-inline-block"},gt=Object.assign({inheritAttrs:!1},{__name:"EmailLeftSidebarContent",emits:["toggleComposeDialogVisibility"],setup(M,{emit:E}){const f=[{title:"Inbox",prependIcon:"ri-mail-line",to:{name:"apps-email"},badge:{content:"21",color:"primary"}},{title:"Sent",prependIcon:"ri-send-plane-line",to:{name:"apps-email-filter",params:{filter:"sent"}}},{title:"Draft",prependIcon:"ri-edit-box-line",to:{name:"apps-email-filter",params:{filter:"draft"}},badge:{content:"2",color:"warning"}},{title:"Starred",prependIcon:"ri-star-line",to:{name:"apps-email-filter",params:{filter:"starred"}}},{title:"Spam",prependIcon:"ri-spam-2-line",to:{name:"apps-email-filter",params:{filter:"spam"}},badge:{content:"4",color:"error"}},{title:"Trash",prependIcon:"ri-delete-bin-7-line",to:{name:"apps-email-filter",params:{filter:"trashed"}}}],V=[{title:"Personal",color:"success",to:{name:"apps-email-label",params:{label:"personal"}}},{title:"Company",color:"primary",to:{name:"apps-email-label",params:{label:"company"}}},{title:"Important",color:"warning",to:{name:"apps-email-label",params:{label:"important"}}},{title:"Private",color:"error",to:{name:"apps-email-label",params:{label:"private"}}}];return(y,A)=>{const I=se("RouterLink");return v(),b("div",rt,[s("div",dt,[e(ie,{block:"",onClick:A[0]||(A[0]=h=>y.$emit("toggleComposeDialogVisibility"))},{default:t(()=>[x(" Compose ")]),_:1})]),e(l(ue),{options:{wheelPropagation:!1},class:"h-100 pt-4"},{default:t(()=>[s("ul",ct,[(v(),b(S,null,T(f,h=>e(I,{key:h.title,class:"d-flex align-center cursor-pointer",to:h.to,custom:""},{default:t(({isActive:g,href:C,navigate:d})=>{var P;return[s("li",fe({ref_for:!0},y.$attrs,{href:C,class:[g&&"email-filter-active text-primary","d-flex align-center cursor-pointer"],onClick:d}),[e(r,{icon:h.prependIcon,class:"me-2",size:"20"},null,8,["icon"]),s("span",mt,$(h.title),1),e(Q),(P=h.badge)!=null&&P.content?(v(),B(me,{key:0,size:"x-small",variant:"tonal",inline:"",class:"v-badge--tonal badge-custom-padding",color:h.badge.color,content:h.badge.content},null,8,["color","content"])):q("",!0)],16,ut)]}),_:2},1032,["to"])),64)),pt,(v(),b(S,null,T(V,h=>e(I,{key:h.title,class:"d-flex align-center",to:h.to,custom:""},{default:t(({isActive:g,href:C,navigate:d})=>[s("li",fe({ref_for:!0},y.$attrs,{href:C,class:[g&&"email-label-active text-primary","cursor-pointer"],onClick:d}),[e(r,{color:h.color,icon:"ri-circle-fill",size:"12",class:"me-2"},null,8,["color"]),s("span",vt,$(h.title),1)],16,ft)]),_:2},1032,["to"])),64))])]),_:1})])}}}),ce=()=>{const M=he(),E=async(g,C)=>{await ge("apps/email",{method:"POST",body:JSON.stringify({ids:g,data:C})})};return{labels:[{title:"personal",color:"success"},{title:"company",color:"primary"},{title:"important",color:"warning"},{title:"private",color:"error"}],resolveLabelColor:g=>g==="personal"?"success":g==="company"?"primary":g==="important"?"warning":g==="private"?"error":"secondary",shallShowMoveToActionFor:g=>g==="trash"?M.params.filter!=="trashed":g==="inbox"?!(M.params.filter===void 0||M.params.filter==="sent"||M.params.filter==="draft"):g==="spam"?!(M.params.filter==="spam"||M.params.filter==="sent"||M.params.filter==="draft"):!1,emailMoveToFolderActions:[{action:"inbox",icon:"ri-mail-line"},{action:"spam",icon:"ri-spam-2-line"},{action:"trash",icon:"ri-delete-bin-line"}],moveSelectedEmailTo:async(g,C)=>{const d={};g==="inbox"?(M.params.filter==="trashed"&&(d.isDeleted=!1),d.folder="inbox"):g==="spam"?(M.params.filter==="trashed"&&(d.isDeleted=!1),d.folder="spam"):g==="trash"&&(d.isDeleted=!0),await E(C,d)},updateEmails:E,updateEmailLabels:async(g,C)=>{await ge("/apps/email",{method:"POST",body:{ids:g,label:C}})}}},_t={class:"email-view-header d-flex align-center px-5 py-4"},ht={class:"d-flex align-center flex-wrap flex-grow-1 overflow-hidden gap-2"},xt={class:"text-body-1 text-high-emphasis text-truncate"},kt={class:"d-flex flex-wrap gap-2"},bt={class:"d-flex align-center gap-2"},yt={class:"email-view-action-bar d-flex align-center text-medium-emphasis gap-1 px-5"},$t={class:"d-flex align-start"},Ct={class:"d-flex flex-wrap flex-grow-1 overflow-hidden"},wt={class:"text-truncate"},Vt={class:"text-h6 font-weight-regular text-truncate"},Lt={class:"text-body-2 mb-0"},Mt={class:"d-flex align-center"},St={class:"text-disabled me-4"},At=["innerHTML"],zt=s("span",null,"Attachments",-1),Et=s("h6",{class:"text-h6 font-weight-regular mb-6"}," Reply to Ross Geller ",-1),It={class:"tiptap-editor-wrapper"},Dt={key:0,class:"d-flex flex-wrap gap-x-2 mb-6"},Rt={class:"d-flex align-center justify-space-between justify-sm-end gap-4 mt-6 flex-wrap"},Ut={__name:"EmailView",props:{email:{type:null,required:!0},emailMeta:{type:Object,required:!0}},emits:["refresh","navigated","close","trash","unread","read","star","unstar"],setup(M,{emit:E}){const f=M,V=E,{updateEmailLabels:y}=ce(),{labels:A,resolveLabelColor:I,emailMoveToFolderActions:h,shallShowMoveToActionFor:g,moveSelectedEmailTo:C}=ce(),d=async c=>{await C(c,[f.email.id]),V("refresh"),V("close")},P=async c=>{await y([f.email.id],c),V("refresh")},_=ye({content:"",extensions:[$e,ke,Ce.configure({placeholder:"Write your message..."}),we,be.configure({openOnClick:!1})]}),L=()=>{var m,O,u;const c=(m=_.value)==null?void 0:m.getAttributes("link").href,a=window.prompt("URL",c);if(a!==null){if(a===""){(O=_.value)==null||O.chain().focus().extendMarkRange("link").unsetLink().run();return}(u=_.value)==null||u.chain().focus().extendMarkRange("link").setLink({href:a}).run()}},i=()=>{var a;const c=window.prompt("URL");c&&((a=_.value)==null||a.chain().focus().setImage({src:c}).run())};return(c,a)=>{const m=se("IconBtn"),O=xe;return v(),B(Me,{temporary:"","model-value":!!f.email,location:"right",scrim:!1,floating:"",class:"email-view"},{default:t(()=>[f.email?(v(),b(S,{key:0},[s("div",_t,[e(m,{class:"me-2 flip-in-rtl",onClick:a[0]||(a[0]=u=>c.$emit("close"))},{default:t(()=>[e(r,{icon:"ri-arrow-left-s-line"})]),_:1}),s("div",ht,[s("h6",xt,$(f.email.subject),1),s("div",kt,[(v(!0),b(S,null,T(f.email.labels,u=>(v(),B(Fe,{key:u,color:l(I)(u),size:"small",class:"text-capitalize flex-shrink-0"},{default:t(()=>[x($(u),1)]),_:2},1032,["color"]))),128))])]),s("div",bt,[e(m,{variant:"plain",disabled:!f.emailMeta.hasPreviousEmail,class:"flip-in-rtl",onClick:a[1]||(a[1]=u=>c.$emit("navigated","previous"))},{default:t(()=>[e(r,{icon:"ri-arrow-left-s-line"})]),_:1},8,["disabled"]),e(m,{variant:"plain",class:"flip-in-rtl",disabled:!f.emailMeta.hasNextEmail,onClick:a[2]||(a[2]=u=>c.$emit("navigated","next"))},{default:t(()=>[e(r,{icon:"ri-arrow-right-s-line"})]),_:1},8,["disabled"])])]),e(U),s("div",yt,[J(e(m,{onClick:a[3]||(a[3]=u=>{c.$emit("trash",f.email.id),c.$emit("close")})},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Delete Mail ")]),_:1})]),_:1},512),[[K,!f.email.isDeleted]]),e(m,{onClick:a[4]||(a[4]=j(u=>{c.$emit("unread"),c.$emit("close")},["stop"]))},{default:t(()=>[e(r,{icon:"ri-mail-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Mark as Unread ")]),_:1})]),_:1}),e(m,null,{default:t(()=>[e(r,{icon:"ri-folder-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Move to ")]),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),b(S,null,T(l(h),u=>(v(),B(ee,{key:u.title,class:ae([l(g)(u.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:F=>d(u.action)},{prepend:t(()=>[e(r,{icon:u.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(oe,{class:"text-capitalize"},{default:t(()=>[x($(u.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(m,null,{default:t(()=>[e(r,{icon:"ri-price-tag-3-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Label ")]),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),b(S,null,T(l(A),u=>(v(),B(ee,{key:u.title,href:"#",onClick:j(F=>P(u.title),["stop"])},{prepend:t(()=>[e(me,{inline:"",color:l(I)(u.title),dot:""},null,8,["color"])]),default:t(()=>[e(oe,{class:"ms-2 text-capitalize"},{default:t(()=>[x($(u.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(Q),e(m,{color:f.email.isStarred?"warning":"default",onClick:a[5]||(a[5]=u=>{var F;return(F=f.email)!=null&&F.isStarred?c.$emit("unstar"):c.$emit("star")})},{default:t(()=>[e(r,{icon:"ri-star-line"})]),_:1},8,["color"]),e(O)]),e(U),e(l(ue),{tag:"div",class:"mail-content-container flex-grow-1",options:{wheelPropagation:!1}},{default:t(()=>[e(ne,{class:"ma-6 mb-4"},{default:t(()=>[e(le,{class:"mail-header"},{default:t(()=>[s("div",$t,[e(Le,{size:"38",class:"me-4"},{default:t(()=>[e(de,{src:f.email.from.avatar,alt:f.email.from.name},null,8,["src","alt"])]),_:1}),s("div",Ct,[s("div",wt,[s("h6",Vt,$(f.email.from.name),1),s("p",Lt,$(f.email.from.email),1)]),e(Q),s("div",Mt,[s("span",St,$(("formatDate"in c?c.formatDate:l(Re))(f.email.time)),1),J(e(m,null,{default:t(()=>[e(r,{icon:"ri-attachment-2"})]),_:1},512),[[K,f.email.attachments.length]])])]),e(O,{class:"align-self-sm-center"})])]),_:1}),e(U),e(le,null,{default:t(()=>[s("div",{class:"text-base",innerHTML:f.email.message},null,8,At)]),_:1}),f.email.attachments.length?(v(),b(S,{key:0},[e(U),e(le,{class:"d-flex flex-column gap-y-4"},{default:t(()=>[zt,(v(!0),b(S,null,T(f.email.attachments,u=>(v(),b("div",{key:u.fileName,class:"d-flex align-center"},[e(de,{src:u.thumbnail,alt:u.fileName,"aspect-ratio":"1","max-height":"24","max-width":"24",class:"me-2"},null,8,["src","alt"]),s("span",null,$(u.fileName),1)]))),128))]),_:1})],64)):q("",!0)]),_:1}),e(ne,{class:"ma-6"},{default:t(()=>[e(le,null,{default:t(()=>[Et,s("div",It,[l(_)?(v(),b("div",Dt,[e(r,{icon:"ri-bold",color:l(_).isActive("bold")?"primary":"",size:"20",onClick:a[6]||(a[6]=u=>l(_).chain().focus().toggleBold().run())},null,8,["color"]),e(r,{color:l(_).isActive("underline")?"primary":"",icon:"ri-underline",size:"20",onClick:a[7]||(a[7]=u=>l(_).commands.toggleUnderline())},null,8,["color"]),e(r,{color:l(_).isActive("italic")?"primary":"",icon:"ri-italic",size:"20",onClick:a[8]||(a[8]=u=>l(_).chain().focus().toggleItalic().run())},null,8,["color"]),e(r,{color:l(_).isActive("bulletList")?"primary":"",icon:"ri-list-check",size:"20",onClick:a[9]||(a[9]=u=>l(_).chain().focus().toggleBulletList().run())},null,8,["color"]),e(r,{color:l(_).isActive("orderedList")?"primary":"",icon:"ri-list-ordered-2",size:"20",onClick:a[10]||(a[10]=u=>l(_).chain().focus().toggleOrderedList().run())},null,8,["color"]),e(r,{icon:"ri-links-line",size:"20",onClick:L}),e(r,{icon:"ri-image-line",size:"20",onClick:i})])):q("",!0),e(l(Ve),{editor:l(_)},null,8,["editor"])]),s("div",Rt,[e(ie,{color:"secondary",variant:"plain","prepend-icon":"ri-attachment-2"},{default:t(()=>[x(" Attachments ")]),_:1}),e(ie,{"append-icon":"ri-send-plane-line"},{default:t(()=>[x(" Send ")]),_:1})])]),_:1})]),_:1})]),_:1})],64)):q("",!0)]),_:1},8,["model-value"])}}},Tt={class:"d-flex align-center"},Bt={class:"py-2 px-4 d-flex align-center"},Pt=["onClick"],Nt={class:"text-h6"},Ot={class:"text-body-2 truncate"},Ft={class:"text-sm text-disabled"},jt={class:"email-actions d-none"},qt={class:"py-4 px-5 text-center"},Ht=s("span",{class:"text-high-emphasis"},"No items found.",-1),Gt=[Ht],Ul={__name:"index",async setup(M){let E,f;const{isLeftSidebarOpen:V}=je(),y=he(),{labels:A,resolveLabelColor:I,emailMoveToFolderActions:h,shallShowMoveToActionFor:g,moveSelectedEmailTo:C,updateEmails:d,updateEmailLabels:P}=ce(),_=D(!1),L=D(""),i=D([]),{data:c,execute:a}=([E,f]=Te(()=>Ge(Je("/apps/email",{query:{q:L,filter:()=>"filter"in y.params?y.params.filter:void 0,label:()=>"label"in y.params?y.params.label:void 0}}))),E=await E,f(),E),m=W(()=>c.value.emails),O=p=>{const n=i.value.indexOf(p);n===-1?i.value.push(p):i.value.splice(n,1)},u=W(()=>m.value.length&&m.value.length===i.value.length),F=W(()=>!!i.value.length&&m.value.length!==i.value.length),re=W(()=>i.value.every(p=>{var n;return(n=m.value.find(w=>w.id===p))==null?void 0:n.isRead})),Se=()=>{i.value=u.value?[]:m.value.map(p=>p.id)},k=D(null),Ae=W(()=>{const p={hasNextEmail:!1,hasPreviousEmail:!1};if(k.value){const n=m.value.findIndex(w=>{var H;return w.id===((H=k.value)==null?void 0:H.id)});p.hasNextEmail=!!m.value[n+1],p.hasPreviousEmail=!!m.value[n-1]}return p}),pe=async()=>{await a(),k.value&&(k.value=m.value.find(p=>{var n;return p.id===((n=k.value)==null?void 0:n.id)}))},z=async(p,n=i.value)=>{i.value=[],n.length&&(p==="trash"?await d(n,{isDeleted:!0}):p==="spam"?await d(n,{folder:"spam"}):p==="unread"?await d(n,{isRead:!1}):p==="read"?await d(n,{isRead:!0}):p==="star"?await d(n,{isStarred:!0}):p==="unstar"&&await d(n,{isStarred:!1}),k.value?pe():await a())},ze=async p=>{await C(p,i.value),await a()},Ee=async p=>{await P(i.value,p),await a()},Ie=p=>{if(!k.value)return;const n=m.value.findIndex(H=>{var o;return H.id===((o=k.value)==null?void 0:o.id)}),w=p==="previous"?n-1:n+1;k.value=m.value[w]},De=async p=>{k.value=p,await z("read",[p.id])};return Be(()=>y.params,()=>{i.value=[]},{deep:!0}),(p,n)=>{const w=se("IconBtn"),H=xe;return v(),B(qe,{style:{"min-block-size":"100%"},class:"email-app-layout"},{default:t(()=>[e(Me,{modelValue:l(V),"onUpdate:modelValue":n[1]||(n[1]=o=>G(V)?V.value=o:null),absolute:"",touchless:"",location:"start",temporary:p.$vuetify.display.mdAndDown},{default:t(()=>[e(gt,{onToggleComposeDialogVisibility:n[0]||(n[0]=o=>_.value=!l(_))})]),_:1},8,["modelValue","temporary"]),e(Ut,{email:l(k),"email-meta":l(Ae),onRefresh:pe,onNavigated:Ie,onClose:n[2]||(n[2]=o=>k.value=null),onTrash:n[3]||(n[3]=o=>z("trash",l(k)?[l(k).id]:[])),onUnread:n[4]||(n[4]=o=>z("unread",l(k)?[l(k).id]:[])),onStar:n[5]||(n[5]=o=>z("star",l(k)?[l(k).id]:[])),onUnstar:n[6]||(n[6]=o=>z("unstar",l(k)?[l(k).id]:[]))},null,8,["email","email-meta"]),e(He,null,{default:t(()=>[e(ne,{flat:"",class:"email-content-list h-100 d-flex flex-column"},{default:t(()=>[s("div",Tt,[e(w,{class:"d-lg-none ms-3",onClick:n[7]||(n[7]=o=>V.value=!0)},{default:t(()=>[e(r,{icon:"ri-menu-line"})]),_:1}),e(X,{modelValue:l(L),"onUpdate:modelValue":n[8]||(n[8]=o=>G(L)?L.value=o:null),density:"default",class:"email-search px-1 flex-grow-1",placeholder:"Search mail"},{"prepend-inner":t(()=>[e(r,{color:"disabled",size:"22",icon:"ri-search-line",class:"me-2"})]),_:1},8,["modelValue"])]),e(U),s("div",Bt,[e(_e,{"model-value":l(u),indeterminate:l(F),class:"me-1","onUpdate:modelValue":Se},null,8,["model-value","indeterminate"]),s("div",{class:"w-100 d-flex align-center action-bar-actions gap-1",style:Pe({visibility:l(F)||l(u)?void 0:"hidden"})},[J(e(w,{onClick:n[9]||(n[9]=o=>z("trash"))},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Delete Mail ")]),_:1})]),_:1},512),[[K,"filter"in l(y).params?l(y).params.filter!=="trashed":!0]]),e(w,{onClick:n[10]||(n[10]=o=>l(re)?z("unread"):z("read"))},{default:t(()=>[e(r,{icon:l(re)?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(R,{activator:"parent",location:"top"},{default:t(()=>[x($(l(re)?"Mark as Unread":"Mark as Read"),1)]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(r,{icon:"ri-folder-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Folder ")]),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),b(S,null,T(l(h),o=>(v(),B(ee,{key:o.title,class:ae([l(g)(o.action)?"d-flex":"d-none","align-center"]),href:"#",onClick:te=>ze(o.action)},{prepend:t(()=>[e(r,{icon:o.icon,class:"me-2",size:"20"},null,8,["icon"])]),default:t(()=>[e(oe,{class:"text-capitalize"},{default:t(()=>[x($(o.action),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(r,{icon:"ri-price-tag-3-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Label ")]),_:1}),e(Y,{activator:"parent"},{default:t(()=>[e(Z,{density:"compact"},{default:t(()=>[(v(!0),b(S,null,T(l(A),o=>(v(),B(ee,{key:o.title,href:"#",onClick:te=>Ee(o.title)},{prepend:t(()=>[e(me,{inline:"",color:l(I)(o.title),dot:""},null,8,["color"])]),default:t(()=>[e(oe,{class:"ms-2 text-capitalize"},{default:t(()=>[x($(o.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})],4),e(Q),e(w,{class:"me-1",onClick:l(a)},{default:t(()=>[e(r,{icon:"ri-refresh-line"})]),_:1},8,["onClick"]),e(H,{class:"text-medium-emphasis"})]),e(U),e(l(ue),{tag:"ul",options:{wheelPropagation:!1},class:"email-list"},{default:t(()=>[(v(!0),b(S,null,T(l(m),o=>{var te;return J((v(),b("li",{key:o.id,class:ae(["email-item d-flex align-center pa-4 gap-2 cursor-pointer",[{"email-read":o.isRead}]]),onClick:N=>De(o)},[e(_e,{"model-value":l(i).includes(o.id),class:"flex-shrink-0","onUpdate:modelValue":N=>O(o.id),onClick:n[11]||(n[11]=j(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"]),e(w,{color:o.isStarred?"warning":"default",onClick:j(N=>z(o.isStarred?"unstar":"star",[o.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-star-line"})]),_:2},1032,["color","onClick"]),e(Le,{size:"32"},{default:t(()=>[e(de,{src:o.from.avatar,alt:o.from.name},null,8,["src","alt"])]),_:2},1024),s("h6",Nt,$(o.from.name),1),s("span",Ot,$(o.subject),1),e(Q),s("div",{class:ae(["email-meta align-center gap-2",p.$vuetify.display.xs?"d-none":""])},[(v(!0),b(S,null,T(o.labels,N=>(v(),B(r,{key:N,icon:"ri-circle-fill",size:"10",color:l(I)(N)},null,8,["color"]))),128)),s("span",Ft,$(("formatDateToMonthShort"in p?p.formatDateToMonthShort:l(Ue))(o.time)),1)],2),s("div",jt,[e(w,{onClick:j(N=>z("trash",[o.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-delete-bin-7-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Delete Mail ")]),_:1})]),_:2},1032,["onClick"]),e(w,{class:"mx-2",onClick:j(N=>z(o.isRead?"unread":"read",[o.id]),["stop"])},{default:t(()=>[e(r,{icon:o.isRead?"ri-mail-line":"ri-mail-open-line"},null,8,["icon"]),e(R,{activator:"parent",location:"top"},{default:t(()=>[x($(o.isRead?"Mark as Unread":"Mark as Read"),1)]),_:2},1024)]),_:2},1032,["onClick"]),e(w,{onClick:j(N=>z("spam",[o.id]),["stop"])},{default:t(()=>[e(r,{icon:"ri-error-warning-line"}),e(R,{activator:"parent",location:"top"},{default:t(()=>[x(" Move to Spam ")]),_:1})]),_:2},1032,["onClick"])])],10,Pt)),[[K,(te=l(m))==null?void 0:te.length]])}),128)),J(s("li",qt,Gt,512),[[K,!l(m).length]])]),_:1})]),_:1}),J(e(st,{onClose:n[12]||(n[12]=o=>_.value=!1)},null,512),[[K,l(_)]])]),_:1})]),_:1})}}};export{Ul as default};
